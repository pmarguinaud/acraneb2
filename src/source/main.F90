PROGRAM MAIN

INTEGER :: JBLK, JLON

!$acc parallel loop gang vector private (JLON,JBLK) collapse (2)
DO JBLK=1, 1
  DO JLON = 1, 32
  CALL ACRANEB2(JLON,JLON,32,1,87)
  ENDDO
ENDDO
!$acc end parallel loop


CONTAINS

SUBROUTINE ACRANEB2(KIDIA,KFDIA,KLON,KTDIA,KLEV)

!$acc routine (ACRANEB2) seq

IMPLICIT NONE

INTEGER,INTENT(IN) :: KIDIA 
INTEGER,INTENT(IN) :: KFDIA 
INTEGER,INTENT(IN) :: KLON 
INTEGER,INTENT(IN) :: KTDIA 
INTEGER,INTENT(IN) :: KLEV 

INTEGER :: JLON, JLEV1, JLEV2

JLON = KIDIA

IF (JLON==1) PRINT *, __FILE__, ':', __LINE__, " JLEV1 = ", KTDIA-1, KLEV
  DO JLEV1=KTDIA-1,KLEV    

IF (JLON==1) PRINT *, __FILE__, ':', __LINE__, " JLEV2 = ", JLEV1+1,KLEV
    DO JLEV2=JLEV1+1,KLEV  
IF (JLON==1) THEN
  PRINT *, __FILE__, ':', __LINE__
  PRINT *, " JLEV2 = ", JLEV2
  PRINT *, " JLEV1+1 = ", JLEV1+1
  PRINT *, JLEV2 == JLEV1+1
ENDIF

    ENDDO
  ENDDO

END SUBROUTINE ACRANEB2
END PROGRAM MAIN
