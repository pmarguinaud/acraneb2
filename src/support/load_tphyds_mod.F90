MODULE LOAD_TPHYDS_MOD

USE YOMPHYDS, ONLY : TPHYDS
USE PARKIND1, ONLY : JPRB, JPRD

INTERFACE LOAD
MODULE PROCEDURE LOAD_TPHYDS
END INTERFACE

CONTAINS

SUBROUTINE LOAD_TPHYDS (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TPHYDS), INTENT (OUT) :: YD
REAL(KIND=JPRD), ALLOCATABLE :: ZTEMP1 (:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTEMP2 (:, :)
READ (KLUN) YD%JPVXP
READ (KLUN) YD%JPVXP2
READ (KLUN) YD%JPCXP
READ (KLUN) YD%JPVEXTR
READ (KLUN) YD%JPVEXTRDI
READ (KLUN) YD%JPVXTR2
READ (KLUN) YD%CEXTRP
READ (KLUN) YD%CXTRP2
READ (KLUN) YD%CVEXTRA
READ (KLUN) YD%CVEXRAD
READ (KLUN) YD%CVEXTRDI
READ (KLUN) YD%CVEXTR2
READ (KLUN) YD%NEXTRPGB
READ (KLUN) YD%NXTRP2GB
READ (KLUN) YD%NVEXTRAGB
READ (KLUN) YD%NVEXRADGB
READ (KLUN) YD%NVEXTR2GB
READ (KLUN) YD%NVEXTRDIGB
READ (KLUN) YD%NSFLUX
READ (KLUN) YD%NSFORC
ALLOCATE (ZTEMP2 (LBOUND (YD%EXTRPDF, 1):UBOUND (YD%EXTRPDF, 1), LBOUND (YD%EXTRPDF, 2):UBOUND (YD%EXTRPDF, 2)))
READ (KLUN) ZTEMP2
YD%EXTRPDF = ZTEMP2
DEALLOCATE (ZTEMP2)
ALLOCATE (ZTEMP1 (LBOUND (YD%XTRP2DF, 1):UBOUND (YD%XTRP2DF, 1)))
READ (KLUN) ZTEMP1
YD%XTRP2DF = ZTEMP1
DEALLOCATE (ZTEMP1)
ALLOCATE (ZTEMP1 (LBOUND (YD%VEXTRADF, 1):UBOUND (YD%VEXTRADF, 1)))
READ (KLUN) ZTEMP1
YD%VEXTRADF = ZTEMP1
DEALLOCATE (ZTEMP1)
ALLOCATE (ZTEMP1 (LBOUND (YD%VEXRADDF, 1):UBOUND (YD%VEXRADDF, 1)))
READ (KLUN) ZTEMP1
YD%VEXRADDF = ZTEMP1
DEALLOCATE (ZTEMP1)
ALLOCATE (ZTEMP1 (LBOUND (YD%VEXTR2DF, 1):UBOUND (YD%VEXTR2DF, 1)))
READ (KLUN) ZTEMP1
YD%VEXTR2DF = ZTEMP1
DEALLOCATE (ZTEMP1)
ALLOCATE (ZTEMP1 (LBOUND (YD%VEXTRDI, 1):UBOUND (YD%VEXTRDI, 1)))
READ (KLUN) ZTEMP1
YD%VEXTRDI = ZTEMP1
DEALLOCATE (ZTEMP1)
READ (KLUN) YD%LREQIN_VEXTRDI
READ (KLUN) YD%LREQOUT_VEXTRDI
END SUBROUTINE


END MODULE
